<?xml version="1.0"?>
<?xml-stylesheet type="text/xml" href="../../config/documentation-stylesheet.xml"?>
<!DOCTYPE isbdocument [
  <!ENTITY % CommonConfig SYSTEM "../../config/CommonConfig.dtd">
  %CommonConfig;
   ]>

<isb:document xmlns:isb="http://www.systemsbiology.org/xmlns"
              xmlns:html="http://www.w3.org/TR/xhtml1"
              xmlns="http://www.w3.org/TR/xhtml1">

<isb:doctitle>Web Pages Management Manual</isb:doctitle>
<isb:docdate>$Date$</isb:docdate>

<isb:doccontents />

<isb:docsection name="Introduction" label="introduction">
<p>
This document contains detailed instructions on how to manage
the &mainGroup; web pages.  The goals of this framework are
automation of the build/upload processes, ease of style
modifications, and integration with our Java code base.
</p>
<p>
If you are in a hurry, you might want to skip ahead to
the <a href="#simpler">simpler method of publishing
web content</a> described below.  Please note the 
<a href="#warning">warning about not uploading web 
content into the default directory on the FTP server</a>
in that section.
</p>
<p>
Please note that most of the software packages mentioned
in this document are available in the &mainGroup; shared
directory, under the &quot;<code>software</code>&quot;
subdirectory.
</p>
</isb:docsection>

<isb:docsection name="Web Pages Format" label="format">
<p>
The &mainGroup; web pages are written in a variant of 
<a href="http://www.w3c.org/MarkUp">XHTML</a> that uses a
special &quot;stylesheet&quot; to unify the &quot;look and feel&quot; 
of the web pages.   The use of a
common stylesheet means that by making an edit to one file, one can (in
principle) modify the look and feel of all of our web pages in a
consistent manner.   The stylesheet used is not CSS (cascading style sheets),
but instead the <a href="http://www.w3c.org/TR/xsl">XSL</a> framework.
</p>
<p>
There is a <a href="SampleDocument.xml.txt">Sample web document</a>
that illustrates how to write a web document using the XSL framework
and the local style sheet conventions.  The version of the 
<a href="SampleDocument.html">sample document
translated (automatically) into HTML</a> is also available.
Note that the only knowledge required in order to write a
web document using this template is a rudimentary understanding of
<a href="http://www.w3.org/MarkUp">XHTML</a>.
</p>

</isb:docsection>
<isb:docsection name="Required Software" label="requiredsoftware">
<p>
Managing the &mainGroup; web pages requires that certain software
programs be installed on your computer.  The process is likely to 
be much easier on a Linux computer, but in principle it should be
do-able on a Windows computer.  You will need the following software
installed on your computer:
</p>
<p>
<ol>
<li><b>CVS client</b><br /> 
Please refer to the <a href="SoftwareDevelopmentGuidelines.html#cvsrepository">
CVS Repository</a> of the Software Development Guidelines document,
for information on how to obtain and use CVS on your desktop computer.
</li>
<li><b>Java Development Kit (JDK)</b><br />
The JDK version 1.4 or newer must be installed on your computer,
or available via a network drive mounted on your computer.  To confirm
that it is installed correctly, you should be able to execute the 
&quot;<code>java -version</code>&quot;
command from your command shell prompt.  A suitable JDK package is 
available from <a href="http://java.sun.com">Sun Microsystems</a>.
If you are using Linux, the JDK software is already available in the
network directory &quot;<code>/tools/java/sdk</code>&quot;.
</li>
<li><b>Ant</b><br />
The Ant program is the software
tool used for &quot;building&quot; the web site.  To confirm that Ant 
is installed correctly, you should be able to run 
&quot;<code>ant -version</code>&quot; from the command prompt. If you
do not have Ant installed on your desktop computer, you can download
the source code from the Apache web site:
<blockquote>
<a href="http://ant.apache.org"><code>http://ant.apache.org</code></a>
</blockquote>
Whether you use an already-built version, or build your own from
sources, you will need to have a version of the Ant program that contains
the optional &quot;<code>ftp</code>&quot; task.  This task appears
to only be included in the Ant program if you build the Ant program
with a special library called &quot;<code>NetComponents.jar</code>&quot;
in your <code>CLASSPATH</code>.  The <code>NetComponents.jar</code>
library is available from the web site:
<blockquote>
<a href="http://www.savarese.org/java/"><code>http://www.savarese.org/java</code></a>
</blockquote>
Make sure that a copy of the <code>NetComponents.jar</code> file is placed
in the &quot;<code>lib</code>&quot; subdirectory of the installation
directory you selected for installing Ant (normally this is something 
like <code>/local/ant</code>). Alternatively, <code>NetComponents.jar</code> 
must be in your <code>CLASSPATH</code> each time your invoke the Ant program.
</li>
<li><b>Xalan/Crimson</b><br />
The Xalan XSL processor and the Crimson XML parser Java libraries are 
both needed.  Both of these *should* be installed with your JDK, but if not,
you will have to download and install them, and make sure the relevant
"JAR" files are in your CLASSPATH environment varaible.  The software
can be downloaded from <a href="http://xml.apache.org">Apache</a>. 
To confirm that Xalan/Crimson are installed correctly, you should be able to run
<blockquote>
<pre>
java org.apache.xalan.xslt.Process -v
</pre>
</blockquote>
from the command prompt.
</li>

</ol>
All of the above software programs are free (open source), and easy to
build and install on your computer.  Building Ant, and installing Ant 
and <code>NetComponents.jar</code>, should just take a few minutes.  
On Linux, if you use the JDK (&quot;<code>java</code>&quot;) found 
in the network directory <code>/tools/java/sdk</code>, you should not 
have to worry about items (2) and (4) above.
</p>
<p>
In addition, your computer will need to be connected to the network, and
you will need to have read access to the &mainGroup; project
directory. The path to this directory is as follows:
<blockquote>
<code>/proj/bolrilab</code>&nbsp;&nbsp;(on Linux)   [note the "u" is missing, intentionally]<br />
<code>\\isb-1\bolourilab</code>&nbsp;&nbsp;(Windows)<br />
</blockquote>
The web pages are stored in a CVS repository in the &mainGroup;
project directory.  To access the web pages, set your CVSROOT
environment variable to 
<blockquote>
<code>/proj/bolrilab/CVS_REPOSITORY</code>&nbsp;&nbsp;(on Linux)<br />
<code>\\isb-1\bolourilab\CVS_REPOSITORY</code>&nbsp;&nbsp;(on Windows)<br />
</blockquote>
Finally, your computer will need to be &quot;behind the firewall&quot;
of the &mainAffiliation;; otherwise, you not be allowed
to upload your web content to the web server.  For security
reasons, the web server does not accept FTP connections for 
the &mainGroup; account from outside the firewall.
</p>
</isb:docsection>

<isb:docsection name="Managing Web Content" label="managing">
<p>
To start managing web content, first make sure you have 
installed all of the required software and executed the 
preliminary steps outlined in the previous section.
Then execute the command
<blockquote>
<pre>
cvs co bolouri
</pre>
</blockquote>
somewhere on your desktop computer.  This &quot;checks out&quot;
the source code for the group web pages onto your computer, from the CVS 
server.  This will create a subdirectory 
&quot;<code>bolouri</code>&quot; of your current working
directory; this subdirectory is known as your CVS 
&quot;enlistment&quot;.  The web content is contained within the 
&quot;<code>bolouri/docs</code>&quot;
subdirectory.  The main group &quot;Resources page&quot;
content is in the file
<blockquote>
<pre>
bolouri/docs/Resources.xml
</pre>
</blockquote>
The contents of the file should be mostly
familiar to people who have written HTML (or XHTML) before.  To modify
the file, just open it in a text editor and make your edits.
</p>
<p> 
To add a <em>new</em> document to our web pages, just add a new file 
(such as &quot;<code>MyFile.xml</code>&quot;) to the
&quot;<code>bolouri/docs</code>&quot; subdirectory.  Make sure the
file name ends with the suffix &quot;<code>.xml</code>&quot;.
Also, the file must be placed in the &quot;<code>bolouri/docs</code>&quot;
directory.  For the contents of this file, you can use the 
existing &quot;<code>Resources.xml</code>&quot; file
as a template to start with.  
</p>
<p>
There is a good <a href="http://www.w3c.org/MarkUp/Guide">tutorial</a>
available on writing proper XHTML.  Note that anything you put in the
web page documentation (i.e., in one of the &quot;<code>.xml</code>&quot;
files within the &quot;<code>bolouri/docs</code>&quot; directory)
must be &quot;strictly compliant&quot; XHTML.  The meaning of this 
statement is fully explained within the specifications and tutorial on 
XHTML referenced in the aforementioned URLs.  
</p>
<p>
The next step is to test out your new web page (or your edits to
an existing web page, whatever the case may be).  This is done by simply
running the command
<blockquote>
<pre>
ant buildHTML
</pre>
</blockquote>
from within the &quot;<code>bolouri</code>&quot; directory.  If there is
an error message, it is probably due to improper XHTML in the edits
(or new content) that you made.  To see a more verbose parser message, run:
<blockquote>
<pre>
java org.apache.xalan.xslt.Process -in docs/MyFile.xml -out build/html/MyFile.html \
                                   -xsl config/documentation-stylesheet.xml -edump
</pre>
</blockquote>
The last &quot;<code>-edump</code>&quot; causes the parser to spit out
a more verbose error message.
</p>
<p>
The next step is to &quot;check in&quot; your new content to the CVS 
repository.  This ensures that the changes will never be lost.  Don&apos;t
worry, there is a way to &quot;undo&quot; your changes if you make a mistake).
All of the steps below assume that your current working directory is the
&quot;<code>bolouri</code>&quot; directory that was created when you 
executed your &quot;<code>cvs co</code>&quot; command above. 
</p>
If you are attempting to add a new web page &quot;<code>MyFile.html</code>&quot;
to the web pages (as described above), run the following commands:
<blockquote>
<pre>
cvs add docs/MyFile.xml
cvs commit -m 'my new xml file' docs/MyFile.xml
</pre>
</blockquote>
Substitute your specific filename for the &quot;<code>MyFile</code>&quot;
above.
If instead you are editing (or adding content to) an existing file
(for instance, the &quot;Resources page&quot; file <code>Resources.xml</code>), run the
following command:
<blockquote>
<pre>
cvs commit -m 'description of my edits' docs/Resources.xml
</pre>
</blockquote>
In both the above cases, the text in between the single quotes is a 
&quot;CVS log message&quot; that you should use to briefly describe 
what you changed. A single sentence usually suffices for the CVS log 
message.

Once you have &quot;committed&quot; your changes to the CVS archive, 
you can then build the web site and &quot;upload&quot; it to the 
web server.  This is accomplished by executing the following commands:
<blockquote>
<pre>
ant buildHTML
ant uploadWeb
</pre>
</blockquote>
At this point, you should be able to point your web browser to
your new web page at (for example):
<blockquote>
<pre>
http://labs.systemsbiology.net/bolouri/MyFile.xml
</pre>
</blockquote>
or the modified group home page at:
<blockquote>
<pre>
http://labs.systemsbiology.net/bolouri
</pre>
</blockquote>
If you have any questions about this process, please contact the
web site maintainer at: <code>&mainGroupEmailSafe;</code>.
</isb:docsection>

<isb:docsection name="Private Web Pages" label="privatepages">
<p>
The above instructions describe how to publish a web page
that will be externally (publically) visible.  To publish
a new web page that is only accessible within the 
&mainAffiliation;, follow the directions in this section.
Note that there is as yet no mechanism for publishing
web content that is only visible to the &mainGroup;;
for that purpose, you should use the group&apos;s shared
network drive.  
</p>
<p>
To publish a web page that is visible only within the 
&mainAffiliation;, create your new web page within the
<blockquote>
<pre>
bolouri/docs/private
</pre>
</blockquote>
directory of your CVS enlistment.  
Be sure to use a web page <em>within</em>
that directory as your template, because the 
funny-looking &quot;DOCTYPE&quot; statement at the
top of the file is different for files in the
&quot;<code>bolouri/docs/private</code>&quot;
subdirectory than it is for files in the
&quot;<code>bolouri/docs</code>&quot; subdirectory.
</p>
</isb:docsection>

<isb:docsection name="Simpler Method to Publish New Pages" label="simpler">
<p>
If you wish to rapidly publish a <b>new</b> web page, and the above
instructions are too burdensome, there is a more direct method
to publish a new web page, and bypass CVS and the aforementioned
&quot;stylesheet&quot; framework.  You may use one of the two
&quot;repositories&quot; established for unmanaged web content,
which is web content that is not auto-generated using the methods 
described in the above sections of this document.  These two
repositories are just subdirectories on the FTP server.  
To use the simple web publishing method, write a HTML document
using your favorite HTML editor, and FTP the document to either 
the &quot;<code>privateRepository</code>&quot; or the
&quot;<code>publicRepository</code>&quot; directory on the 
following FTP server:
<blockquote>
<pre>
labs.systemsbiology.net
</pre>
</blockquote>
The two directories differ in that the public directory
is intended for web content that is visible to the outside,
and the private directory is intended for web content that
is visible only to the &mainAffiliation;
You should log into the FTP server using username
&quot;<code>bolouri_group</code>&quot;.  The password
can be obtained by asking one of the permanent staff
in the &mainGroup;.  Once your FTP connection is established,
you select the aforementioned directory using the 
&quot;<code>cd</code>&quot; command:
<ol>
<li>If you do want the document
to be accessible from outside, do the following:
<blockquote>
<pre>
cd publicRepository
</pre>
</blockquote> 
</li>
<li>If you do <em>not</em> want the
document to be accessible from outside, do the following:
<blockquote>
<pre>
cd privateRepository
</pre>
</blockquote>
</li>
</ol>
You can then upload your document (&quot;<code>YourDocument.html</code>)
using the &quot;<code>put</code>&quot; command:
<blockquote>
<pre>
put YourDocument.html
</pre>
</blockquote>
At this point, your document should be visible on the
external web server, at one of the two following URLs:
<blockquote>
<pre>
http://labs.systemsbiology.net/bolouri/privateRepository/YourDocument.html
http://labs.systemsbiology.net/bolouri/publicRepository/YourDocument.html
</pre>
</blockquote>
depending on whether you selected (1) or (2) above.
As emphasized above, files within the public repository
are visible to anyone on the Internet.  Files within
the private repository are only accessible to hosts
within the &mainAffiliation;.
</p>
<p>
<a name="warning" />
<blockquote>
<b>WARNING:</b> Please do not upload your web content 
directly into the default directory 
&quot;<code>bolouri_group</code>&quot; on the FTP server.  
Instead upload into either the
&quot;<code>publicRepository</code>&quot; or the
&quot;<code>privateRepository</code>&quot; directory,
as described above.  Most importantly, please be careful 
not to accidentally overwrite any of the web content that 
is already on the web server, when you are uploading your 
web content!
</blockquote>
</p>
</isb:docsection>

<isb:docsection name="Generating PDF" label="generatingpdf">
<p>
If you wish to be able to build PDF documentation in an automated
fashion through the Ant build system, you will need to
have several additional software installed on your computer:
<ol>
<li><b>html2ps</b><br />
In order to be able to convert HTML documentation to PostScript format
(which is a necessary step in order to convert it to PDF format), you 
will need to have the <code>html2ps</code> program installed on your computer.
This simple program is availble from the 
<a href="http://www.tdb.uu.se/~jan/html2ps.html">HTML2PS Home Page</a>.
</li>
<li><b>htmltidy</b><br />
In order to work around bugs in the <code>html2ps</code> program, it
is necessary to &quot;tidy&quot; the XHTML output from the Xalan XSL
translator, before converting the XHTML to PostScript.  This requires
the use of the &quot;htmltidy&quot; program, available at
<a href="http://tidy.sourceforge.net">the htmltidy home page</a>.  The
executable program installed by this software package is called 
&quot;<code>tidy</code>&quot;.
</li>
<li><b>ps2pdf</b><br />
The <code>ps2pdf</code> program is used to convert PostScript files to
PDF format.  This program should already be installed on your
computer, if you have a modern desktop Linux distribution. 
</li>
<li><b>pdfdoclet</b><br />
The <code>pdfdoclet</code> program is used to generate Javadoc documentation
in PDF format.  This program is available from
<a href="http://pdfdoclet.sourceforge.net"><code>pdfdoclet.sourceforget.net</code></a>.
This program must be installed and the three libraries that ship with it
must be in your <code>CLASSPATH</code>:
<blockquote>
<pre>
pdfdoclet.jar
itext.jar
jakarta-regexp.jar
</pre>
</blockquote>
Make sure that the Ant program is capable
</li>
</ol>
The above three items are needed <em>only</em> if you are going to
(re-)generate PDF documentation from the original XML/Javadoc sources.
You will need to make sure that your <code>PATH</code> environment
variable is updated so that the <code>html2ps</code> and <code>tidy</code>
programs appear in your command path.  This means that when you type, for example,
<blockquote>
<pre>
tidy -help
</pre>
</blockquote>
at the shell prompt, you see the usage information for the <code>tidy</code>
program:
<blockquote>
<pre>
tidy [option...] [file...] [option...] [file...]
Utility to clean up and pretty print HTML/XHTML/XML
see http://tidy.sourceforge.net/
...
</pre>
</blockquote>
And similarly for <code>html2ps</code>, you should be able to enter
at the command prompt:
<blockquote>
<pre>
html2ps -help
</pre>
</blockquote>
and you should see the following result:
<blockquote>
<pre>
unknown option: -help
Usage:
 html2ps [-2cdDFghHLnORtTuUv] [-b URL] [-C string] [-e encoding]
  [-f file[:file[:...]]] [-i num] [-k file] [-l lang] [-m num] [-N num]
  [-o file] [-r path] [-s num] [-S string] [-W string] [-x num]
  [file|URL [file|URL [...]]]
</pre>
</blockquote>
The above steps will ensure that the Ant build system is able to find
the required external programs <code>html2ps</code> and <code>tiny</code>
that are needed in order to generate documentation in PDF format.
</p>
<p>
All of the PDF documentation for the &mainGroup; software
is (so far) generated from XML sources and from Javadoc
comments in Java source code.  
To re-generate PDF documentation from the XML and javadoc
sources, you would first check in your changes to the source
files, and then do:
<blockquote>
<pre>
ant buildHTML
ant buildPDF
ant uploadWeb
</pre>
</blockquote>
The last command uploads the web content to the FTP server.
Note that the &quot;<code>pdfdoclet</code>&quot; software product 
(used to generate a PDF version of Javadoc API documentation) is
still quite experimental, and its support for fancy HTML constructs
in Javadoc comments is rather shaky.
</p>
<p>
If you wish to generate PDF documentation &quot;by hand&quot; from
a HTML document, you can chain together the following tools in order
to accomplish the task.  Assuming that your HTML document is named
&quot;<code>myDoc.html</code>&quot;, the following steps should convert
the document into &quot;<code>myDoc.pdf</code>&quot;:
<blockquote>
<pre>
tidy myDoc.html &gt; myDoc-tidy.html
html2ps myDoc-tidy.html &gt; myDoc.ps
ps2pdf myDoc.ps myDoc.pdf
</pre>
</blockquote>
Note that <code>tidy</code> always spits out a lot of warning
messages, unless you use the <code>-quiet</code> directive.
If your document &quot;<code>myDoc.html</code>&quot; is strict
XHTML rather than ordinary HTML, the <code>tidy</code> command
would be a bit different:
<blockquote>
<pre>
tidy -xml -asxhtml myDoc.xhtml &gt; myDoc.xhtml
</pre>
</blockquote>
The reason why <code>tidy</code> is necessary is because the
<code>html2ps</code> program is very sensitive to correct input
formatting.  
</p>
</isb:docsection>

<isb:docsection name="Model Repository" label="repository">
<p>
The &mainGroup; model repository directory is used to archive 
biomolecular or mathematical models that have been 
found to be useful in our research, and that 
are believed to be of sufficient utility and validity 
to warrant making them available to the general public.
Any model definition file placed in this directory will
be publically visible on our external web server.
</p>
<p>
To &quot;publish&quot; a model in this repository, 
the following steps should be used:
<ol>
<li>check out the &quot;<code>bolouri</code>&quot;
CVS archive using the 
<a href="#managing">checkuot directions</a> above.</li>
<li>copy your model definition file (for the sake
of discussion, we will assume it is named 
&quot;<code>myModel.dizzy</code>&quot;), to the
subdirectory &quot;<code>bolouri/docs/models</code>&quot;
in the CVS &quot;enlistment&quot; that was created in step (1)</li>
<li>edit the <code>index.xml</code> file in the
aforementioned directory using a text editor, 
and add a new list element and hyperlink to your
file.  The link will look something like this:
<blockquote>
<pre>
&lt;li&gt;&lt;a href="myModel.dizzy"&gt;my really interesting model&lt;/a&gt;&lt;/li&gt;
</pre>
</blockquote>
where you will substitute your own description in place of
the text &quot;my really interesting model&quot; above.
</li>
<li>save your edits to <code>index.xml</code>
and execute the following command from within
the top-level directory &quot;<code>bolouri</code>&quot; 
of your enlistment:
<blockquote>
<pre>
cvs add docs/models/myModel.dizzy
cvs commit -m 'my new model' docs/models/myModel.dizzy
</pre>
</blockquote>
</li>
<li>from that same directory, run the command:
<blockquote>
<pre>
ant buildHTML
</pre>
</blockquote>
This should publish your new model definition file
to the Biomolecular Model Repository on the public web site.
</li>
</ol>
</p>
</isb:docsection>

<isb:docsection name="Personal Home Pages" label="pershomepages">
<p>
This section presents specific instructions to publish 
your personal web page on the lab intranet.  To begin, 
simply write (or export) the web page as a HTML document.
For example, my personal home page is <code>sramsey.html</code>.
Next, use the FTP program to transfer the document to
the FTP server <code>labs.systemsbiology.net</code>,
as shown here:
<blockquote>
<pre>
ftp labs.systemsbiology.net
username:  bolouri_group
password:  XXXXXXX
cd publicRepository
put sramsey.html
</pre>
</blockquote>
<b>IMPORTANT NOTE:</b>  make sure you store the file in the "publicRepository"
directory on the FTP server.  
The HTML file uploaded in the previous example will be visible as the
following URL:
<blockquote>
<pre>
<a href="../publicRepository/sramsey.html">http://labs.systemsbiology.net/bolouri/publicRepository/sramsey.html</a>
</pre>
</blockquote>
At this point, your home page is visible to the outside world.  If you wish
to have your home page only visible within the Institute, you should store
the home page in the directory &quot;<code>privateRepository</code>&quot;,
rather than &quot;<code>publicRepository</code>&quot; as shown above.
</p>
<p>
You can then e-mail Tatiana Gill (<code>tgill at systemsbiology.net</code>) \
and ask her to add a hyperlink to your personal home page, on the external-facing
Bolouri Group home page.
</p>

</isb:docsection>

</isb:document>